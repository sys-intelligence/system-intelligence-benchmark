You are an expert TLA+ specification specialist with extensive experience in concurrent systems and spinlock synchronization.

I need you to fix errors in a TLA+ specification for a spinlock {system_type} system.

## Original Task Description
{description}

## Current TLA+ Specification (with errors)
```tla
{current_specification}
```

## Current TLC Configuration
```cfg
{current_config}
```

## Validation Errors Found
**Error Summary:**
{error_summary}

**Detailed Syntax Errors:**
{syntax_errors}

**Detailed Semantic Errors:**
{semantic_errors}

**Full Validation Output:**
```
{validation_output}
```

## Correction Instructions
This is correction attempt {attempt_number} of {max_attempts}.

Based on the validation errors above, please fix BOTH the TLA+ specification AND the TLC configuration if needed while maintaining the intended spinlock synchronization semantics.

Key considerations for spinlock correctness:
1. Ensure proper modeling of atomic test-and-set operations
2. Maintain mutual exclusion and safety properties
3. Fix any syntax errors while preserving the spinlock logic
4. Ensure all variables and operators are properly declared
5. Preserve dual API semantics: blocking lock() vs non-blocking try_lock()
6. **CRITICAL SEMANTIC DISTINCTION**: 
   - lock(): blocking call that can spin (idle → trying → spinning → ... → locked)
   - try_lock(): non-blocking call that never spins (idle → trying → locked OR idle)
   - Model different state transitions based on call type
   - try_lock() requests MUST NEVER enter "spinning" state
7. **MANDATORY Spec Definition with Fairness**: The Spec definition MUST include appropriate fairness assumptions (e.g., WF_Vars for unlock operations or overall progress) to ensure liveness properties.

CRITICAL OUTPUT REQUIREMENTS:
1. Return your response as pure JSON text with NO markdown formatting
2. Your response must start with {{ and end with }}
3. Use this exact structure:

{{
  "specification": "---- MODULE spin ----\n...\n====",
  "configuration": "SPECIFICATION Spec\n..."
}}

4. The MODULE name must remain exactly "spin"
5. Both fields are required - if config does not need changes, return the original
6. Properly escape newlines as \n in the JSON strings
7. Do NOT wrap the JSON in ```json or any other markers
8. Start your specification directly with: ---- MODULE spin ----
9. End your specification with the closing ====
10. Do not include explanations, just the fixed specification and configuration
